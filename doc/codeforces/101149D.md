---
title: Codeforces Gym 101149D 最小割
date: 2017-09-09 08:52:33
tags:
 - 最小割
categories:
 - Codeforces
---

题目链接：[D. Behind the Wall](http://codeforces.com/gym/101149/problem/D)

给出一块 $n \times m$ 的区域，每个坐标都有一个值，代表在此处建墙的花费。给出一个定点，要求建墙将这个定点围起来（不可以在该定点处建墙）。求建墙的最小总花费，并输出方案。

<!-- more -->

将给出的定点看做源点，边界上的所有点看做汇点，就转化为了“删除一圈总容量最小的结点，使源点到汇点的流量为 0，这是个典型的最小割问题。

每个结点都可以向它的上下左右四个方向发送无穷大的流量，而流过每个点的流量是有限制的，因此可以进行拆点操作，将一个点拆为一个入点和一个出点，入点到出点的容量即为该点的流量限制。同时，建立一个超级汇点，边界上的所有出点到该汇点的容量均为无穷大。源点可以发送无穷大的流量。在此图上跑最小割即可。

跑完最小割后还需要输出答案，为此需要在最后的残存网络上遍历出源点集，在对应的坐标将该点集的所有点标记为 2。这就是整个被围成的区域。为了求该区域的边界，还需要再进行遍历，从区域外部遍历，标记出区域的轮廓即可（轮廓上所有点标记为 1）。

> 注意，遍历源点集必须在残存图中跑，不可以在坐标系中根据满流的点来判断。
 
> 给出一组测试数据：

> ```
5 5 3 3
1 1 1 1 1
1 9 9 9 1
1 9 0 9 1
1 9 9 9 1
1 1 1 1 1
```

> 结果：

> ```
12
.XXX.
X...X
X...X
X...X
.XXX.
```

我使用了 Ford-Fulkerson 算法跑出最大流（最小割），然后 BFS 遍历源点集和边界。

{% include_code acm-solutions/Codeforces/Gym/101149/D.cpp %}
